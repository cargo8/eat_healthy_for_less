{% extends "base.html" %}
{% block head %}
<script>
// Replacement Handler
function repl(replaceId, newmeal) {
  console.log(replaceId + newmeal)
  $('#meal'+replaceId).html($('#meal-'+newmeal).html())
  $('#changeMealModal').modal('hide')
}

$(document).ready(function() {
  $("#btn-modal1").click(function(event) {
    var replaced_meal = $('#meal1').html()
    replaced_meal = replaced_meal.replace('<a href="javascript:void(0)" class="btn" id="btn-modal1" style="float:right;">Change Meal</a>', '')
    $('.modal-replaced-meal').html(replaced_meal)
    // option meals have meal-# as id
    var options = "<div class='span8'><div class='content-box' id='meal-0'  ><!-- Result link and text --><div class='span1' style='margin-bottom:55px;'><h4>I have other plans.</h4><a href='javascript:void(0)' class='btn' onclick='repl(1,0)' id='btn-modal-0' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-1'' value='0' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% for result in results_set.1.alterns|slice:":3" %}
    options = options +"<div class='span8'><div class='content-box' id='meal-{{forloop.counter}}' ><!-- Result link and text --><div class='span1' style='margin-bottom:55px;'><h4><a href='{{ result.url }}'>{% autoescape off %} {# This is for showing raw html symbols #}{{ result.name }}{% endautoescape %}</a></h4><div class='hidden-desktop' style='float:left; margin-right:10px;'><img src='{{ result.img }}' /></div>~${{ result.est_price }}, {{ result.cook_time }} minutes<a href='javascript:void(0)' onclick='repl(1,{{forloop.counter}})' class='btn' id='btn-modal-{{forloop.counter}}' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-1' value='{{ result.name }}' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% endfor %}
    $('.meal-options').html(options)

    $('#changeMealModal').modal('show')
  })

  $("#btn-modal2").click(function(event) {
     var replaced_meal = $('#meal2').html()
    replaced_meal = replaced_meal.replace('<a href="javascript:void(0)" class="btn" id="btn-modal2" style="float:right;">Change Meal</a>', '')
    $('.modal-replaced-meal').html(replaced_meal)
    // option meals have meal-# as id
    var options = "<div class='span8'><div class='content-box' id='meal-0'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4>I have other plans.</h4><a href='javascript:void(0)' class='btn' onclick='repl(2,0)' id='btn-modal-0' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-2'' value='0' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% for result in results_set.2.alterns|slice:":3" %}
    options = options +"<div class='span8'><div class='content-box' id='meal-{{forloop.counter}}'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4><a href='{{ result.url }}'>{% autoescape off %} {# This is for showing raw html symbols #}{{ result.name }}{% endautoescape %}</a></h4><div class='hidden-desktop' style='float:left; margin-right:10px;'><img src='{{ result.img }}' /></div>~${{ result.est_price }}, {{ result.cook_time }} minutes<a href='javascript:void(0)' onclick='repl(2,{{forloop.counter}})' class='btn' id='btn-modal-{{forloop.counter}}' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-2 value='{{ result.name }}' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% endfor %}
    $('.meal-options').html(options)

    $('#changeMealModal').modal('show')
  })

  $("#btn-modal3").click(function(event) {
     var replaced_meal = $('#meal3').html()
    replaced_meal = replaced_meal.replace('<a href="javascript:void(0)" class="btn" id="btn-modal3" style="float:right;">Change Meal</a>', '')
    $('.modal-replaced-meal').html(replaced_meal)
    // option meals have meal-# as id
    var options = "<div class='span8'><div class='content-box' id='meal-0'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4>I have other plans.</h4><a href='javascript:void(0)' class='btn' onclick='repl(3,0)' id='btn-modal-0' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-3'' value='0' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% for result in results_set.3.alterns|slice:":3" %}
    options = options +"<div class='span8'><div class='content-box'  id='meal-{{forloop.counter}}' ><!-- Result link and text --><div class='span1' style='margin-bottom:55px;'><h4><a href='{{ result.url }}'>{% autoescape off %} {# This is for showing raw html symbols #}{{ result.name }}{% endautoescape %}</a></h4><div class='hidden-desktop' style='float:left; margin-right:10px;'><img src='{{ result.img }}' /></div>~${{ result.est_price }}, {{ result.cook_time }} minutes<a href='javascript:void(0)' onclick='repl(3,{{forloop.counter}})' class='btn' id='btn-modal-{{forloop.counter}}' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-3 value='{{ result.name }}' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% endfor %}
    $('.meal-options').html(options)

    $('#changeMealModal').modal('show')
  })

  $("#btn-modal4").click(function(event) {
     var replaced_meal = $('#meal4').html()
    replaced_meal = replaced_meal.replace('<a href="javascript:void(0)" class="btn" id="btn-modal4" style="float:right;">Change Meal</a>', '')
    $('.modal-replaced-meal').html(replaced_meal)
    // option meals have meal-# as id
    var options = "<div class='span8'><div class='content-box' id='meal-0'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4>I have other plans.</h4><a href='javascript:void(0)' class='btn' onclick='repl(4,0)' id='btn-modal-0' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-4'' value='0' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% for result in results_set.4.alterns|slice:":3" %}
    options = options +"<div class='span8'><div class='content-box' id='meal-{{forloop.counter}}'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4><a href='{{ result.url }}'>{% autoescape off %} {# This is for showing raw html symbols #}{{ result.name }}{% endautoescape %}</a></h4><div class='hidden-desktop' style='float:left; margin-right:10px;'><img src='{{ result.img }}' /></div>~${{ result.est_price }}, {{ result.cook_time }} minutes<a href='javascript:void(0)' onclick='repl(4,{{forloop.counter}})' class='btn' id='btn-modal-{{forloop.counter}}' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-4' value='{{ result.name }}' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% endfor %}
    $('.meal-options').html(options)

    $('#changeMealModal').modal('show')
  })

  $("#btn-modal5").click(function(event) {
    var replaced_meal = $('#meal5').html()
    replaced_meal = replaced_meal.replace('<a href="javascript:void(0)" class="btn" id="btn-modal5" style="float:right;">Change Meal</a>', '')
    $('.modal-replaced-meal').html(replaced_meal)
    // option meals have meal-# as id
    var options = "<div class='span8'><div class='content-box' id='meal-0'  ><!-- Result link and text --><div class='span1' style='margin-bottom:55px;'><h4>I have other plans.</h4><a href='javascript:void(0)' class='btn' onclick='repl(5,0)' id='btn-modal-0' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-5'' value='0' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% for result in results_set.5.alterns|slice:":3" %}
    options = options +"<div class='span8'><div class='content-box' id='meal-{{forloop.counter}}'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4><a href='{{ result.url }}'>{% autoescape off %} {# This is for showing raw html symbols #}{{ result.name }}{% endautoescape %}</a></h4><div class='hidden-desktop' style='float:left; margin-right:10px;'><img src='{{ result.img }}' /></div>~${{ result.est_price }}, {{ result.cook_time }} minutes<a href='javascript:void(0)' onclick='repl(5,{{forloop.counter}})' class='btn' id='btn-modal-{{forloop.counter}}' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-5' value='{{ result.name }}' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% endfor %}
    $('.meal-options').html(options)

    $('#changeMealModal').modal('show')
  })

  $("#btn-modal6").click(function(event) {
    var replaced_meal = $('#meal6').html()
    replaced_meal = replaced_meal.replace('<a href="javascript:void(0)" class="btn" id="btn-modal6" style="float:right;">Change Meal</a>', '')
    $('.modal-replaced-meal').html(replaced_meal)
    // option meals have meal-# as id
    var options = "<div class='span8'><div class='content-box' id='meal-0'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4>I have other plans.</h4><a href='javascript:void(0)' class='btn' onclick='repl(6,0)' id='btn-modal-0' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-6'' value='0' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% for result in results_set.6.alterns|slice:":3" %}
 options = options +"<div class='span8'><div class='content-box' id='meal-{{forloop.counter}}'><!-- Result link and text --><div class='span1'  style='margin-bottom:55px;'><h4><a href='{{ result.url }}'>{% autoescape off %} {# This is for showing raw html symbols #}{{ result.name }}{% endautoescape %}</a></h4><div class='hidden-desktop' style='float:left; margin-right:10px;'><img src='{{ result.img }}' /></div>~${{ result.est_price }}, {{ result.cook_time }} minutes<a href='javascript:void(0)' onclick='repl(6,{{forloop.counter}})' class='btn' id='btn-modal-{{forloop.counter}}' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-6' value='{{ result.name }}' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% endfor %}
    $('.meal-options').html(options)

    $('#changeMealModal').modal('show')
  })

  $("#btn-modal7").click(function(event) {
     var replaced_meal = $('#meal7').html()
    replaced_meal = replaced_meal.replace('<a href="javascript:void(0)" class="btn" id="btn-modal7" style="float:right;">Change Meal</a>', '')
    $('.modal-replaced-meal').html(replaced_meal)
    // option meals have meal-# as id
    var options = "<div class='span8'><div class='content-box' id='meal-0'  ><!-- Result link and text --><div class='span1' style='margin-bottom:55px;'><h4>I have other plans.</h4><a href='javascript:void(0)' class='btn' onclick='repl(7,0)' id='btn-modal-0' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-7'' value='0' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% for result in results_set.7.alterns|slice:":3" %}
    options = options +"<div class='span8'><div class='content-box' id='meal-{{forloop.counter}}' ><!-- Result link and text --><div class='span1' style='margin-bottom:55px;'><h4><a href='{{ result.url }}'>{% autoescape off %} {# This is for showing raw html symbols #}{{ result.name }}{% endautoescape %}</a></h4><div class='hidden-desktop' style='float:left; margin-right:10px;'><img src='{{ result.img }}' /></div>~${{ result.est_price }}, {{ result.cook_time }} minutes<a href='javascript:void(0)' onclick='repl(7,{{forloop.counter}})' class='btn' id='btn-modal-{{forloop.counter}}' style='float:right;'>Choose Meal</a><input type='hidden' name='meal-7' value='{{ result.name }}' /></div></div> <!-- /span --></div> <!-- /row -->"
    {% endfor %}
    $('.meal-options').html(options)

    $('#changeMealModal').modal('show')
  })

  $("#confirmModalChange").click(function(event) {
    // TODO: save the modal changes
  })
})
</script>
{% endblock %}


{% block content %}
<!-- Modal for login/not_login -->
<div id="changeMealModal" class="modal hide fade" tabindex="-1"
     role="dialog" aria-labelledby="changeMealModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal"
            aria-hidden="true">x</button>
    <h3 id="changeMealModalLabel">Change this meal</h3>
  </div>
  <div class="modal-body">
    <h4>Replace...</h4>
    <div class="modal-replaced-meal content-box"></div>
    <h4>with...</h4>
    <div class="meal-options"></div>
  </div>
  <div class="modal-footer">
    <a href="javascript:void(0)" onclick="$('#changeMealModal').modal('hide')" class="btn">Go Back</a>
    <!-- <a href="javascript:void(0)" id="confirmModalChange" class="btn btn-primary">Confirm Change</a> -->
  </div>
</div>

<div class="container-fluid" style="margin-bottom:100%;">
    <!-- Search results section -->
<form class="" action="/savemeals/" method="get">

{% for result in results_set %}
{% ifequal forloop.counter 1 %}
  <h2>Monday</h2>
{% endifequal %}
{% ifequal forloop.counter 2 %}
  <h2>Tuesday</h2>
{% endifequal %}
{% ifequal forloop.counter 3 %}
  <h2>Wednesday</h2>
{% endifequal %}
{% ifequal forloop.counter 4 %}
  <h2>Thursday</h2>
{% endifequal %}
{% ifequal forloop.counter 5 %}
  <h2>Friday</h2>
{% endifequal %}
{% ifequal forloop.counter 6 %}
  <h2>Saturday</h2>
{% endifequal %}
{% ifequal forloop.counter 7 %}
  <h2>Sunday</h2>
{% endifequal %}
     <div class="span8">
      <div class="content-box" id="meal{{forloop.counter}}">
        <input type="hidden" name="meal-{{ forloop.counter }}" value="{{ result.name }}" />
        <!-- Result link and text -->
        <div class="span1" style="margin-bottom:55px;">
          <h4>
            <a href="{{ result.url }}">
          {% autoescape off %} {# This is for showing raw html symbols #}
          {{ result.name }}
          {% endautoescape %}
        </a>
          </h4>
              <div class='hidden-desktop' style="float:left; margin-right:10px;">
                <img src='{{ result.img }}' />
              </div>
              ~${{ result.est_price }}, {{ result.cook_time }} minutes
              <a href="javascript:void(0)" class="btn" id="btn-modal{{forloop.counter}}" style="float:right;">Change Meal</a>
            </div>
        </div> <!-- /span -->
      </div> <!-- /row -->
{% endfor %}

  <input type='hidden' name='cals' value='{{cals}}'/>
  <button type="submit" class="btn btn-success btn-large pull-right">Looks good!</button>
  <button type="submit" style="margin-right:5px;" class="btn btn-large pull-right">Go back</button>
</form>
{% if results.size == 0 %}
<p>Sorry, we couldn't find any results matching your budget.</p>
{% endif %}

</div> <!-- /span Search Results section END -->

{% endblock %}
